<div class="container mt-5">
  <h1>My Todo List</h1>

  <div class="mb-3">
    <%= link_to "All", tasks_path(filter: 'all'), class: "btn btn-outline-primary #{'active' if @filter == 'all'}" %>
    <%= link_to "Pending", tasks_path(filter: 'pending'), class: "btn btn-outline-primary #{'active' if @filter == 'pending'}" %>
    <%= link_to "Complete", tasks_path(filter: 'complete'), class: "btn btn-outline-primary #{'active' if @filter == 'complete'}" %>
    <%= link_to 'Add New Task', new_task_path, class: 'btn btn-success float-end', remote: true %>
  </div>

  <ul class="list-group">
    <% @tasks.each do |task| %>
      <li class="list-group-item d-flex justify-content-between align-items-center">
        <div>
          <% if task.complete? %>
            <del><%= task.title %></del>
          <% else %>
            <%= task.title %>
          <% end %>
          <br>
          <small class="text-muted"><%= truncate(task.description, length: 50) %></small>
        </div>
        <div>
          <% unless task.complete? %>
            <%= link_to complete_task_path(task), method: :patch, class: "btn btn-sm btn-success me-2" do %>
              <i class="bi bi-check-circle"></i> Complete
            <% end %>
            <%= link_to edit_task_path(task), class: "btn btn-sm btn-primary me-2", remote: true do %>
              <i class="bi bi-pencil-square"></i> Edit
            <% end %>
          <% end %>
          <%= link_to task_path(task), method: :delete, data: { confirm: 'Are you sure?' }, class: "btn btn-sm btn-danger" do %>
            <i class="bi bi-trash"></i> Delete
          <% end %>
        </div>
      </li>
    <% end %>
  </ul>
</div>

<div class="modal fade" id="task-modal" tabindex="-1" aria-labelledby="taskModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content" id="modal-form-body">
      <%= render partial: 'form', locals: { task: Task.new }%>
    </div>
  </div>
</div>